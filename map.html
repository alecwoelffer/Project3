<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <style type="text/css">
      html { height: 100% }
      body { height: 100%; margin: 0; padding: 0 }
      #map-canvas { height: 100% }
    </style>
    <script type="text/javascript"
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBfzQLVgFbpnRbeTk4EKkhBsBgTzZN5P0c&sensor=true">
    </script>
    <script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script type="text/javascript">
      //Creates the Map 
      var gmarkers = [];
      var map; 
      function initialize() {
        var mapOptions = {
          center: new google.maps.LatLng(30.673353,-96.368637),
          zoom: 12,
          mapTypeId: google.maps.MapTypeId.ROADMAP,
        };
        var styles = [
          {
            stylers: [
              { hue: "#00ffee" },
              { saturation: -100 }
            ]
          },{
            featureType: "road",
            elementType: "geometry",
            stylers: [
              { lightness: 100 },
              { visibility: "simplified" }
            ]
          }
        ]; 

        map = new google.maps.Map(document.getElementById("map-canvas"), mapOptions);
        map.setOptions({styles: styles});

        //Police Station 1
        var policeinfo = "<p><b>College Station Police Department:</b> " + "<br><b>Address:</b> " + "2611 Texas Ave S, College Station, TX" + "<br><b>Contact Info:</b> " + "(979) 764-3692";
        var police1 = new google.maps.LatLng(30.602699, -96.303439);
        var marker1 = new google.maps.Marker({
          map: map,
          position: police1,
          icon: "police.png"
        });
        var policewindow = new google.maps.InfoWindow({
                content: policeinfo
        });
        google.maps.event.addListener(marker1, 'click', function(){
            policewindow.open(map,marker1);
        });

        //Police Station 2
        var policeinfo2 = "<p><b>Bryan Police Department:</b> " + "<br><b>Address:</b> " + "303 E 29th St, Bryan, TX" + "<br><b>Contact Info:</b> " + "(979) 209-5300";
        var police2 = new google.maps.LatLng(30.670495, -96.371719);
        var marker2 = new google.maps.Marker({
          map: map,
          position: police2,
          icon: "police.png"
        });
        var policewindow2 = new google.maps.InfoWindow({
                content: policeinfo2
        });
        google.maps.event.addListener(marker2, 'click', function(){
            policewindow2.open(map,marker2);
        });

        //Police Station 3
        var policeinfo3 = "<p><b>Texas A&M Police Department:</b> " + "<br><b>Address:</b> " + "1111 Research Pkwy, College Station, TX" + "<br><b>Contact Info:</b> " + "(979) 845-2345";
        var police3 = new google.maps.LatLng(30.603513, -96.36211);
        var marker3 = new google.maps.Marker({
          map: map,
          position: police3,
          icon: "police.png"
        });
        var policewindow3 = new google.maps.InfoWindow({
                content: policeinfo3
        });
        google.maps.event.addListener(marker3, 'click', function(){
            policewindow3.open(map,marker3);
        });

        //Parse Json File for Crime Data
         $.getJSON("2011data.json",function(data){
          $.each(data, function (key, val){
              var info = "<p><b>Crime:</b> " + val["crime"]+ "<br><b>Address:</b> " + val["address"] + "<br><b>Date:</b> " + val["date"];
              var coordinates = new google.maps.LatLng(val["lat"], val["lng"]);
              if(val["crime"] == "Theft" || val["crime"] == "theft"){
                  var marker = new google.maps.Marker({
                    map: map, 
                    position: coordinates,
                    title: info,
                    icon: "theft.png"
                  });
                  marker.category = val["crime"];
                  marker.coordinates = coordinates; 
                  gmarkers.push(marker);
              }
              if(val["crime"] == "Vandalism" || val["crime"]  == "vandalism"){
                  var marker = new google.maps.Marker({
                    map: map, 
                    position: coordinates,
                    title: info,
                    icon: "vandalism.png"
                  });
                  marker.category = val["crime"];
                  marker.coordinates = coordinates; 
                  gmarkers.push(marker);
              }
              if(val["crime"] == "Other" || val["crime"] == "other"){
                  var marker = new google.maps.Marker({
                    map: map, 
                    position: coordinates,
                    title: info,
                    icon: "other.png"
                  });
                  marker.category = val["crime"];
                  marker.coordinates = coordinates; 
                  gmarkers.push(marker);
              }
              if(val["crime"] == "Assault" || val["crime"] == "assault"){
                  var marker = new google.maps.Marker({
                    map: map, 
                    position: coordinates,
                    title: info,
                    icon: "assault.png"
                  });
                  marker.category = val["crime"];
                  marker.coordinates = coordinates; 
                  gmarkers.push(marker);
              }
              if(val["crime"] == "arson" || val["crime"] == "Arson"){
                  var marker = new google.maps.Marker({
                    map: map, 
                    position: coordinates,
                    title: info,
                    icon: "arson.png"
                  });
                  marker.category = val["crime"];
                  marker.coordinates = coordinates; 
                  gmarkers.push(marker);
              }
              if(val["crime"] == "Burglary" || val["crime"] == "burglary"){
                  var marker = new google.maps.Marker({
                    map: map, 
                    position: coordinates,
                    title: info,
                    icon: "burglary.png"
                  });
                  marker.category = val["crime"];
                  marker.coordinates = coordinates; 
                  gmarkers.push(marker);
              }
              if(val["crime"] == "shooting" || val["crime"] == "Shooting"){
                  var marker = new google.maps.Marker({
                    map: map, 
                    position: coordinates,
                    title: info,
                    icon: "shooting.png"
                  });
                  marker.category = val["crime"];
                  marker.coordinates = coordinates; 
                  gmarkers.push(marker);
              }
              if(val["crime"] == "arrest" || val["crime"] == "Arrest"){
                  var marker = new google.maps.Marker({
                    map: map, 
                    position: coordinates,
                    title: info,
                    icon: "arrest.png"
                  });
                  marker.category = val["crime"];
                  marker.coordinates = coordinates; 
                  gmarkers.push(marker);
              }
              if(val["crime"] == "robbery" || val["crime"] == "Robbery"){
                  var marker = new google.maps.Marker({
                    map: map, 
                    position: coordinates,
                    title: info,
                    icon: "shooting.png"
                  });
                  marker.category = val["crime"];
                  marker.coordinates = coordinates; 
                  gmarkers.push(marker);
              }
              hide("Assault");
              hide("Theft");
              hide("Arrest");
              hide("Burglary");
              hide("Shooting");
              hide("Robbery");
              hide("Vandalism");
              hide("Other");
              var infowindow = new google.maps.InfoWindow({
                content: info
              });

              google.maps.event.addListener(marker, 'click', function(){
                 infowindow.open(map,marker);
              });
            });
        });
       }

       function boxclick(box, cat){
        if(box.checked){
          show(cat);
        } else {
          hide(cat);
        }
       }
       function show(cat){
          for(var i = 0; i < gmarkers.length; i++){
            if(gmarkers[i].category == cat){
              gmarkers[i].setVisible(true);
            }
          }
       }
       function hide(cat){
         for(var i = 0; i < gmarkers.length; i++){
            if(gmarkers[i].category == cat){
              gmarkers[i].setVisible(false);
            }
          }
       }
       var geocoder; 
      //Show Home Address 
       function codeAddress(){
        geocoder = new google.maps.Geocoder();
        var sAddress = document.getElementById("inputTextAddress").value;
        geocoder.geocode( { 'address': sAddress}, function(results, status) { 
          if (status == google.maps.GeocoderStatus.OK) {
            map.setCenter(results[0].geometry.location);
            var home_marker = new google.maps.Marker({
              map: map,
              position: results[0].geometry.location,
              icon: "house.png"
            });
             var homeinfo = "<p><b>Home Location</b> " + "<br><b>Address:</b> " + document.getElementById("inputTextAddress").value;
             var homewindow = new google.maps.InfoWindow({
                content: homeinfo
               });
            google.maps.event.addListener(home_marker, 'click', function(){
               homewindow.open(map,home_marker);
            });
          }
          else{
            alert("Geocode was not successful for the following reason: " + status);
          }
        });
       }

        
      
      google.maps.event.addDomListener(window, 'load', initialize);
    </script>
  </head>
  <body>
    
    <div id="map-canvas"style="width: 1000px; height: 500px;"></div>
     <div>
      Assault: 
        <input id = "assault_box" type = "checkbox" onclick="boxclick(this,'Assault')"> </input>
      Arrest: 
        <input id = "arrest_box" type = "checkbox" onclick="boxclick(this,'Arrest')"> </input>
      Burglary:
        <input id = "burglary_box" type = "checkbox" onclick="boxclick(this,'Burglary')"> </input>
      Robbery: 
        <input id = "robbery_box" type = "checkbox" onclick="boxclick(this,'Robbery')"> </input>
      Theft:
        <input id = "theft_box" type = "checkbox" onclick="boxclick(this,'Theft')"> </input>
      Vandalism:
        <input id = "vandalism_box" type = "checkbox" onclick="boxclick(this,'Vandalism')"> </input>
      Other:
        <input id = "other_box" type = "checkbox" onclick="boxclick(this,'Other')"> </input>
      <input type="text" id="inputTextAddress" style=" width:200px" title="Address to Geocode" />
      <input type="button" onclick="codeAddress()" id="inputButtonGeocode" style="width:150px" title="Home Address" value="Home Address" />
    <div>
  </body>
</html>
